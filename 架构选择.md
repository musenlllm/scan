# 架构选择

### go-zero 微服务架构

#### 介绍

- 原因：考虑到属于一小部分，但也可以被以后的功能复用

- 优点（弹性、可重用代码）

  - 可以将域名解析、IP（段）扫描、服务、系统识别等看作为大型应用的部分独立组件。
  - 每个服务独立服务由一个小型团队负责，不影响其他部分开发。
  - 每个服务不强调使用同一种语言，实现技术自由。

  {容器 云原生}

- 缺点
  - 诞生出很多组件用于辅助

go天生适配云原生，docker\k8s，

### go 微服务的现有派系

#### 1. 标准库/自研派系

不要让框架束缚开发

go标准库的性能、稳定、

微服务的基础是通信、也就是RPC框架的选择，grpc或者再自研rpc框架的研发【HTTP性能差一些，自研的不一定适配】

grpc HTTP2

有需要其他的组件就使用就行

部署采用k8s，比如istio处理

#### 2. Web框架派系

gin(稳定、在生产环境中稳定很重要，适配性强)+grpc

部署采用k8s+istio

#### 3. 大一统框架

受别的语言影响，其他语言都有成熟的大一统框架支撑

新手好上手

减轻工作量，快速开发，但是需要遵循框架的规则

#### go-zero 国人开发、文档齐全、社区活跃

# go-zero使用

## 1. 环境准备

- go 安装
- goctl安装（代码生成工具）
  - api服务生成（对外）
  - rpc服务生成（对内）
  - model代码生成
  - 模块管理
- protoc & protoc-gen-go安装

​	`goctl env check -i -f --verbose`

### 3. 微服务的

需求梳理：

- 查看已经扫描过的资产

要部署多个扫描工作节点，可以按照以下步骤进行：

一、准备工作

1. **确定节点数量**：根据扫描需求和服务器的承载能力，确定需要部署的扫描工作节点数量。
2. **准备服务器或虚拟机**：为每个工作节点准备一台服务器或虚拟机，确保它们具有足够的计算资源和网络连接。
3. **安装操作系统和依赖**：在每个节点上安装相同的操作系统，并安装所需的依赖和软件包，以确保环境的一致性。

二、部署工作节点

1. **复制配置文件**：将主节点的配置文件复制到每个工作节点上，确保配置一致。
2. **安装扫描工具**：在每个工作节点上安装扫描工具，并确保版本一致。
3. **配置网络环境**：确保每个工作节点都能访问Kafka集群和其他必要的网络资源。
4. **启动扫描服务**：在每个工作节点上启动扫描服务，并确保它们能够正常接收和处理扫描任务。

三、集成到分布式系统

1. **连接Kafka集群**：配置每个工作节点以连接到Kafka集群，以便它们可以从Kafka主题中拉取扫描任务并将结果发送回Kafka。
2. **负载均衡**：在分布式系统中实施负载均衡策略，以确保扫描任务能够均匀地分配到各个工作节点上。
3. **监控和日志记录**：设置监控和日志记录机制，以便跟踪每个工作节点的状态和性能，并在需要时进行故障排除。

四、测试与验证

1. **发送测试任务**：向Kafka集群发送一些测试扫描任务，以验证工作节点是否能够正确接收和处理这些任务。
2. **检查结果**：检查每个工作节点的扫描结果，确保它们符合预期并具有一致性。
3. **性能调优**：根据测试结果进行必要的性能调优，以提高扫描速度和准确性。

通过以上步骤，你可以成功地部署多个扫描工作节点，并将它们集成到一个分布式扫描系统中。这些节点将能够并行处理扫描任务，从而提高整体扫描效率和性能。



sk-DDfSVhaY4BtGAvgL3eAb3a44C6154d6d9252090625Cc4563